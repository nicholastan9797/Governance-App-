//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table user {
  id String [pk]
  name String [unique, not null]
  email String [not null, default: '']
  subscriptions subscription [not null]
  voters voter [not null]
  newuser Boolean [not null, default: true]
  acceptedterms Boolean [not null, default: false]
  acceptedtermstimestamp DateTime
  dailybulletin Boolean [not null, default: false]
  lastactive DateTime [default: `now()`, not null]
  sessioncount Int [not null, default: 0]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]
}

Table voter {
  id String [pk]
  address String [unique, not null]
  votes vote [not null]
  voterhandlers voterhandler [not null]
  users user [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]
}

Table dao {
  id String [pk]
  name String [unique, not null]
  picture String [not null]
  handlers daohandler [not null]
  proposals proposal [not null]
  subscriptions subscription [not null]
  votes vote [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]
}

Table daohandler {
  id String [pk]
  type DAOHandlerType [not null]
  decoder Json [not null]
  chainindex BigInt [default: 0]
  snapshotindex DateTime [default: 2000-01-01T00:00:00+00:00]
  lastrefresh DateTime [not null, default: 2000-01-01T00:00:00+00:00]
  refreshstatus RefreshStatus [not null, default: 'NEW']
  uptodate Boolean [not null, default: false]
  refreshspeed BigInt [not null, default: 1000000]
  votersrefreshspeed BigInt [not null, default: 50000000]
  daoid String [not null]
  dao dao [not null]
  proposals proposal [not null]
  voterhandlers voterhandler [not null]
  votes vote [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]

  indexes {
    (daoid, type) [unique]
  }
}

Table proposal {
  id String [pk]
  name String [not null]
  externalid String [not null]
  choices Json [not null]
  scores Json [not null]
  scorestotal Json [not null]
  quorum Json [not null]
  blockcreated BigInt [default: 0]
  timecreated DateTime [not null]
  timestart DateTime [not null]
  timeend DateTime [not null]
  url String [not null]
  daohandlerid String [not null]
  daohandler daohandler [not null]
  daoid String [not null]
  dao dao [not null]
  votes vote [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]

  indexes {
    (externalid, daoid) [unique]
  }
}

Table vote {
  id String [pk]
  choice Json [not null]
  votingpower Json [not null]
  reason String [not null]
  voteraddress String [not null]
  voter voter [not null]
  proposalid String [not null]
  proposal proposal [not null]
  daoid String [not null]
  dao dao [not null]
  daohandlerid String [not null]
  daohandler daohandler [not null]
  blockcreated BigInt [default: 0]
  timecreated DateTime
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]

  indexes {
    (voteraddress, daoid, proposalid) [unique]
  }
}

Table voterhandler {
  id String [pk]
  chainindex BigInt [default: 0]
  snapshotindex DateTime [default: 2000-01-01T00:00:00+00:00]
  lastrefresh DateTime [not null, default: 2000-01-01T00:00:00+00:00]
  refreshstatus RefreshStatus [not null, default: 'NEW']
  uptodate Boolean [not null, default: false]
  daohandlerid String [not null]
  daohandler daohandler [not null]
  voterid String [not null]
  voter voter [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]

  indexes {
    (voterid, daohandlerid) [unique]
  }
}

Table subscription {
  id String [pk]
  notificationsenabled Boolean [not null, default: true]
  userid String [not null]
  user user [not null]
  daoid String [not null]
  dao dao [not null]
  createdat DateTime [default: `now()`, not null]
  updatedat DateTime [not null]

  indexes {
    (userid, daoid) [unique]
  }
}

Table config {
  key String [pk]
  value Int [not null]
}

Enum DAOHandlerType {
  AAVE_CHAIN
  COMPOUND_CHAIN
  UNISWAP_CHAIN
  ENS_CHAIN
  GITCOIN_CHAIN
  HOP_CHAIN
  DYDX_CHAIN
  MAKER_EXECUTIVE
  MAKER_POLL
  MAKER_POLL_ARBITRUM
  SNAPSHOT
}

Enum RefreshStatus {
  NEW
  PENDING
  DONE
}

Ref: daohandler.daoid > dao.id [delete: Cascade]

Ref: proposal.daohandlerid > daohandler.id [delete: Cascade]

Ref: proposal.daoid > dao.id [delete: Cascade]

Ref: vote.voteraddress > voter.address [delete: Cascade]

Ref: vote.proposalid > proposal.id [delete: Cascade]

Ref: vote.daoid > dao.id [delete: Cascade]

Ref: vote.daohandlerid > daohandler.id [delete: Cascade]

Ref: voterhandler.daohandlerid > daohandler.id [delete: Cascade]

Ref: voterhandler.voterid > voter.id [delete: Cascade]

Ref: subscription.userid > user.id [delete: Cascade]

Ref: subscription.daoid > dao.id [delete: Cascade]